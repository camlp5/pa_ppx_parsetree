--- pprintast.ml	2023-04-09 23:34:40.403776641 -0700
+++ pprintast.ml	2023-04-09 23:34:55.236272466 -0700
@@ -1068,17 +1068,19 @@
 
 and with_constraint ctxt f = function
   | Pwith_type (li, ({ptype_params= ls ;_} as td)) ->
+      let ls = List.map fst ls in
       pp f "type@ %a %a =@ %a"
-        (type_params ctxt) ls
-        longident_loc li (type_declaration ctxt) td
+        (list (core_type ctxt) ~sep:"," ~first:"(" ~last:")")
+        ls longident_loc li (type_declaration ctxt) td
   | Pwith_module (li, li2) ->
       pp f "module %a =@ %a" longident_loc li longident_loc li2;
   | Pwith_modtype (li, mty) ->
       pp f "module type %a =@ %a" longident_loc li (module_type ctxt) mty;
   | Pwith_typesubst (li, ({ptype_params=ls;_} as td)) ->
+      let ls = List.map fst ls in
       pp f "type@ %a %a :=@ %a"
-        (type_params ctxt) ls
-        longident_loc li
+        (list (core_type ctxt) ~sep:"," ~first:"(" ~last:")")
+        ls longident_loc li
         (type_declaration ctxt) td
   | Pwith_modsubst (li, li2) ->
       pp f "module %a :=@ %a" longident_loc li longident_loc li2
